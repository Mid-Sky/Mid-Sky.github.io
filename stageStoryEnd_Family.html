<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"
        integrity="sha512-uaz5GpnQoE6t5echKlX8P52czvsIGgLPcvlzfvRubLZ1Hp8JemUDnbUiAahbVtPb+jUVrNETuXvAhDDF/N3M4w=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/addons/p5.sound.js"
        integrity="sha512-TU9AWtV5uUZPX8dbBAH8NQF1tSdigPRRT82vllAQ1Ke28puiqLA6ZVKxtUGlgrH6yWFnkKy+sE6luNEGH9ar0A=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="p5.play.js" type="text/javascript"></script>
    <script defer src="https://unpkg.com/p5.collide2d"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <script>
        let max_width = window.innerWidth
        let max_height = window.innerHeight

        let gameFont
        let background_pic

        let storyEndFamily = [
            "2 were told,\n you see it with your own eyes, 'Soul' is filled with treasures and scraps ",
            "UIWADNHAUIDHAUD contain the exact materials you need to fix\n your ship with your high-tech detector ",
            "'2 heard them shout on your way to one of the site, you need to hurry now",
            "As you approach closer to the site,\n you see that there are two galaxy pirates there, as if they are guarding something ",
            "Maybe I can either (blue) do it \nstealthily from them and get what I need or I can (red) fight them \nto make them keep quiet ",
            "2222222 end  "

        ]

        function preload(){
            gameFont = loadFont("font.ttf")
            background_pic = loadImage("EndFamily.jpg")
            background_music = loadSound("spaceSound.mp3")
        }

        function setup() {
            createCanvas(max_width, max_height)
            rectMode(CENTER)
            textAlign(CENTER)
            imageMode(CENTER)
            textFont(gameFont)

            background_music.setVolume(0.3)
            background_music.play()

            //keep track where the story line the player is on
            currentstoryEndFamily = parseInt(sessionStorage.getItem('currentstoryEndFamily')) || 0
            displayStoryEnd_Family()

            // Play the background music
            background_music.setVolume(0.3)
            background_music.loop();

        }// close set up

        //Stage1 Story
        function displayStoryEnd_Family() {
            background(0);
            image(background_pic, max_width/2,max_height/2, max_width,max_height)
            textSize(25)
            fill("maroon")
            text("Click to continue...", max_width / 2, max_height - 10)
            if(currentstoryEndFamily != 4){
                fill("white")
            }
            if(currentstoryEndFamily == 4){
                fill("skyblue")
            }
            text(storyEndFamily[currentstoryEndFamily], max_width / 2, max_height -300);
        }//close Stage1 Story
        //Stage1 Story mouseClicked
        function mouseClicked() {
            // If there are more story parts to show
            if (currentstoryEndFamily < storyEndFamily.length - 1) {
                currentstoryEndFamily++

                // Save the current part index to sessionStorage
                sessionStorage.setItem('currentstoryEndFamily', currentstoryEndFamily)

                // Update the display
                displayStoryEnd_Family()
            }// close If there are more story parts to show
            else {
                // If the user is at the last part of the story, go to intro()
                localStorage.setItem("stage", 100)
                location.href = "stage.html"
            }
        }//close Stage1 Story mouseClicked
    </script>
</body>

</html>